generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Venda {
  id        Int      @id @default(autoincrement())
  data      DateTime @default(now())
  total     Decimal
  
  clienteId Int?     // <--- NOVO: ID do cliente (pode ser nulo/vazio)
  cliente   Cliente? @relation(fields: [clienteId], references: [id]) // <--- A Conexão

  itens     ItemVenda[]

  @@map("vendas")
}

model ItemVenda {
  id         Int     @id @default(autoincrement())
  quantidade Decimal @db.Decimal(10, 3)
  precoUnit  Decimal @map("preco_unitario") @db.Decimal(10, 2)
  vendaId    Int     @map("venda_id")
  produtoId  Int     @map("produto_id")
  produto    Produto @relation(fields: [produtoId], references: [id])
  venda      Venda   @relation(fields: [vendaId], references: [id])

  @@map("itens_venda")
}

// ... seus outros models (Produto, Venda, etc) ...

model Cliente {
  id        Int      @id @default(autoincrement())
  nome      String
  cpfCnpj   String?
  celular   String?
  endereco  String?
  criadoEm  DateTime @default(now())

  vendas    Venda[]  // <--- NOVO: O cliente tem várias vendas
  @@map("clientes")
}

model User {
  id       String   @id @default(uuid())
  nome     String
  email    String   @unique
  senha    String
  cargo    String
  criadoEm DateTime @default(now())
}

model Produto {
  id          Int         @id @default(autoincrement())
  nome        String
  codigoBarra String?     @unique
  precoCusto  Float
  precoVenda  Float
  estoque     Int
  unidade     String?
  categoria   String?
  fornecedor  String?
  localizacao String?
  ipi         Float?      @default(0)
  icms        Float?      @default(0)
  frete       Float?      @default(0)
  ncm         String?
  cest        String?
  cfop        String?
  itens       ItemVenda[]
}
